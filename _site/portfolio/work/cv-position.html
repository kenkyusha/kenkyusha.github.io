<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    
    <!-- Website verification -->
    <meta name="google-site-verification" content="">

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Computer Vision - based Position Estimation | Human Machine Interface | Arne Niitsoo</title>
    <meta name="author" content="Arne  Niitsoo">
    <meta name="description" content="At the intersection of machine learning and human-centered design, I am passionate about creating intelligent systems that bridge the gap between humans and technology. With 7 years of experience in the field, I have honed my skills in designing machine learning algorithms that interact with the real world in a natural and intuitive way. From autonomous vehicles to smart homes, my projects demonstrate the power of machine learning in enhancing our lives and solving real-world problems.
">
    <meta name="keywords" content="data science, machine learning, deep learning, recommendation systems, natural language processing, semantic similarity, information retrieval, large language models, LLM, computer vision, python, pytorch, tensorflow, fintech, healthtec, medtech">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="http://localhost:4000/portfolio/work/cv-position">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/">Human Machine Interface | Arne Niitsoo</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Computer Vision - based Position Estimation</h1>
            <p class="post-description"></p>
          </header>

          <article>
            <p>
  Back in the fall of 2018, while I was working at the Fraunhofer IIS (Nürnberg), I stumbled upon a problem, which one of my collegues was working on. The problem itself called inside-out positioning, where a forklift or other kind of moving autonomous system needs to position itself using the RGB cameras and perhaps additional information from other sensors. <a href="https://www.mad.tf.fau.de/files/2018/07/Evaluation-Criteria-for-Inside-Out-Indoor-Positioning-Systems-based-on-Machine-Learning.pdf" target="_blank" rel="external nofollow noopener">(read more here).</a> 

</p>

<h2 id="warehouse-dataset">Warehouse Dataset</h2>
<p>My previous employer (current at that time), Fraunhofer, published the <a href="https://www.iis.fraunhofer.de/en/ff/lv/dataanalytics/opt/warehouse.html" target="_blank" rel="external nofollow noopener">datasets</a>, which consist of the absolute position (X,Y,Z) and the quaternions (w,p,q,r) and the corresponding 360° images (6 in total) for each of them. The data is divided into training and testing sets. The training set consisting of driving through the measurement arena following a predefined horizonthal or vertical path. The testing set contains new independent recordings, which follow 8 different trajectories testing different criteria.</p>

<h2 id="image-processing">Image Processing</h2>
<p>After following the <a href="https://www.mad.tf.fau.de/files/2018/07/Evaluation-Criteria-for-Inside-Out-Indoor-Positioning-Systems-based-on-Machine-Learning.pdf" target="_blank" rel="external nofollow noopener">publication</a>, I found that they followed the conventional image classification pre-processing scheme, which is depicted below. First the mean image is calculated over the datasets, then these values are used to normalize the images. Additionally a center-crop is performed in order to provide more robustness and mitigate overfitting -  common approach used in image classification.</p>

<div style="text-align:center"><img src="/assets/img/projects/cvpos/1.jpg"></div>
<p><br></p>

<p>After trying to follow the same steps and plotting the images as seen above, I noticed that when we go from the original image on the most left side to the very right side then a lot of valuable information could be lost!</p>

<h2 id="edges">Edges!</h2>
<p>As I was digging into this problem I also was suprised how come the network did not manage to get good accuracy measures. The training sets both horizonthal and vertical have very good coverage of the whole measurement arena and thus the network should atleast be capabale of overfitting to that.
Furthermore, I did not understand the reason for center cropping as this is usually used when less data is available and should be considered as optional tool.</p>

<div style="text-align:center"><img src="/assets/img/projects/cvpos/2.jpg"></div>
<p><br></p>

<p>Thus, I decided to try out something new, instead of center cropping I simply scaled the image down to the network input size (224x224) and instead of mean image reduction I performed edge detection on the images… et voila!</p>

<div style="text-align:center"><img src="/assets/img/projects/cvpos/3.jpg"></div>
<p><br></p>

<h2 id="the-network">The Network</h2>
<p>Now instead of blurry, shadowy image we have less color channeles meaning instead of having a conventional RGB image of 3 channels, we now have black and white image with 1 channel, hence our CNN would have less parameters to learn! The CNN architecture used in the paper was based on a modification of <a href="https://arxiv.org/pdf/1409.4842.pdf" target="_blank" rel="external nofollow noopener">GoogleNet</a> using special output from the PoseNet.</p>

<div style="text-align:center"><img src="https://raw.githubusercontent.com/kenkyusha/cv_position/master/pictures/model_plot.png" width="50%"></div>
<p><br></p>

<p>I decided to try something simpler based on some of my earlier work with less layers and designed <a href="https://raw.githubusercontent.com/kenkyusha/cv_position/master/pictures/model_plot.png" target="_blank" rel="external nofollow noopener">the network architecture depicted above.</a></p>

<h2 id="results">Results</h2>

<p>Following are the results testing with the cross dataset:</p>

<div style="text-align:center"><img src="/assets/img/projects/cvpos/4.jpg"></div>
<p><br></p>

<p>From left to right, sys4, sys5, sys6 - these depict the orientation of the camera on the forklift (i.e. which direction the camera is facing).</p>

<table>
  <thead>
    <tr>
      <th>Implemenatation</th>
      <th>MAE</th>
      <th>CEP</th>
      <th>CE95</th>
      <th>deg (CEP)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cross (original)</td>
      <td>1.08 m</td>
      <td>0.86 m</td>
      <td>3.06 m</td>
      <td>0.18 °</td>
    </tr>
    <tr>
      <td>smallNet (sys4)</td>
      <td>0.35 m</td>
      <td>0.30 m</td>
      <td>0.74 m</td>
      <td>0.10 °</td>
    </tr>
    <tr>
      <td>smallNet (sys5)</td>
      <td>0.37 m</td>
      <td>0.35 m</td>
      <td>0.71 m</td>
      <td>0.04 °</td>
    </tr>
    <tr>
      <td>smallNet (sys7)</td>
      <td>0.59 m</td>
      <td>0.43 m</td>
      <td>1.48 m</td>
      <td>0.03 °</td>
    </tr>
  </tbody>
</table>

<p>The numerical results in terms of mean absulte error, circular error probability and CE95.</p>

<p>For implementation details, check out more at my <a href="https://github.com/kenkyusha/cv_position" target="_blank" rel="external nofollow noopener">github page.</a></p>

          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Arne  Niitsoo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.
Last updated: April 14, 2023.
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-177262811-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ window.dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-177262811-1');
  </script><!-- Cronitor RUM -->
<script async src="https://rum.cronitor.io/script.js"></script>
<script>
    window.cronitor = window.cronitor || function() { (window.cronitor.q = window.cronitor.q || []).push(arguments); };
    cronitor('config', { clientKey: '0becbec9d8fd010afa6a15bd679b2300' });
</script>
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
