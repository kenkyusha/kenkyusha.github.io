<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    
    <!-- Website verification -->
    <meta name="google-site-verification" content="">

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CNN-based Position Estimation | Arne Niitsoo | GenAI Specialist</title>
    <meta name="author" content="Arne  Niitsoo">
    <meta name="description" content="We improved high-precision positioning using Convolutional Neural Networks (CNN) for radio signal analysis. Achieved impressive results in challenging multipath scenarios, demonstrating the potential of machine learning for precise positioning.">
    <meta name="keywords" content="data science, machine learning, deep learning, recommendation systems, natural language processing, semantic similarity, information retrieval, large language models, LLM, computer vision, python, pytorch, tensorflow, fintech, healthtec, medtech, conversational AI">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="http://localhost:4000/portfolio/work/mlpos">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/">Arne Niitsoo | GenAI Specialist</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">CNN-based Position Estimation</h1>
            <p class="post-description">We improved high-precision positioning using Convolutional Neural Networks (CNN) for radio signal analysis. Achieved impressive results in challenging multipath scenarios, demonstrating the potential of machine learning for precise positioning.</p>
          </header>

          <article>
            <div style="text-align:center"> <iframe allowfullscreen="" frameborder="0" height="540" src="https://www.youtube.com/embed/TlWucuVcF5Q" width="860"></iframe> </div>

<p>
Above we can see a demonstrator platform built for the Mobile World Congress Barcelona 2018 in the context of Industrial 5G IOT high precision positioning. The taxi-robot is carrying with it a rack with some boxes, which have tags denoted with colored circles. These tags are emitting bursts of radio signals which are captured by the positioning antenna system. The circles colored in green are being processed by the conventional signal processing chain, whereas the circle in yellow is skipping the conventional signal processing and powered by machine learning model a deep convolutional neural network. We are observing here the non-linear effects caused by the multiple racks and reflector walls, which create massive distortions in the received signal. The conventional signal processing chain has difficulties tracking the tag in this kind of environment whereas the ML-powered approach is quite steady. This work has been carried out as I was working at the Fraunhofer IIS.
</p>

<h2 id="channel-impulse-response">Channel Impulse Response</h2>

<div style="text-align:center"><img src="/assets/img/projects/mlpos/2.png" width="100%"></div>

<p>In the figure above, we can see plot of a received channel impulse response with direct line-of-sight (in blue) and one with multipath reflections (in red). The the conventional signal processing chain tries to find the time-of-arriva (TOA), which is the peak i.e. the maximum of the signal and disregards everything else. This works well, if we have direct line-of-sight and clear signal as we see above colored in blue. However, in the case of signal reflections, scattering, multipath and other non-linear effects the received signal has several peaks and it is harder to tell which one of them is the correct TOA. The information around the peaks, denoted with green circles, is completly ignored, which actually could carry a lot of additional information regarding the effects we experience on the signal.</p>

<h2 id="data-processing">Data Processing</h2>
<div style="text-align:center"><img src="/assets/img/projects/mlpos/3.png" width="100%"></div>
<p><br>
The received channel impulse response consists of real and imaginary coefficients and since we have signals from several antenna units (in this case 12). The real and imaginary channels are the combined into a 2-dimensional image, where they follow a CxHxW format. That is real and imaginary channels C, then H being the number of antenna units and W number of coefficients. Above on the left figure, we can see the 12 received signals plotted together and on the right side we see them from a birdview prospective after being converted into a 2D image.</p>

<h2 id="datasets">Datasets</h2>
<div style="text-align:center"><img src="/assets/img/projects/mlpos/4.png" width="100%"></div>
<p><br></p>

<h3 id="meander">Meander</h3>
<p>The trajectories plotted above, were used for training and testing the methodology. On the left side, we can see the trajectory named “Meander”, which has been divided into two different sets. First, the short-slice, where shorts slices are cut out from the trajectory and used only in the testing phase, whereas rest is used for training. Secondly, the long-slice, where the whole sequence is cut out in order to see whether the model could interpolate between the training samples it has seen.</p>

<h3 id="displaced-rectangles">Displaced Rectangles</h3>
<p>On the right, we can see the trajectory used for testing against the multipath. The trajectory contains a “tunnel” for signal propagation created by absorber walls and other reflective material. This is a scenario, where the conventional signal processing does not work very well.</p>

<h2 id="results">Results</h2>

<h3 id="slicing-evaluation">Slicing Evaluation</h3>
<div style="text-align:center"><img src="/assets/img/projects/mlpos/5.png" width="100%"></div>
<p><br>
The figures above show the results of the slicing evaluation. The color difference shows the size of the error, i.e. the more green the more closer to the ground-truth position.</p>

<table>
  <thead>
    <tr>
      <th>Implemenatation</th>
      <th>MAE</th>
      <th>CEP</th>
      <th>CE95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Short Slices</td>
      <td>0.265 m</td>
      <td>0.236 m</td>
      <td>0.571 m</td>
    </tr>
    <tr>
      <td>Long Slices</td>
      <td>0.339 m</td>
      <td>0.265 m</td>
      <td>0.771 m</td>
    </tr>
  </tbody>
</table>

<h3 id="multipath-scenario">Multipath Scenario</h3>
<div style="text-align:center"><img src="/assets/img/projects/mlpos/6.png" width="100%"></div>
<p><br>
This scenario as been split into 2 sections, one in the multipath area, which is where the signal “tunnel” is created with the absorber walls and other reflective material. And the second one in the line of sight conditions.</p>

<table>
  <thead>
    <tr>
      <th>Implemenatation</th>
      <th>MAE</th>
      <th>CEP</th>
      <th>CE95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Multipath (EKF)</td>
      <td>2.11 m</td>
      <td>1.45 m</td>
      <td>5.29 m</td>
    </tr>
    <tr>
      <td>Multipath (CNN)</td>
      <td>0.292 m</td>
      <td>0.229 m</td>
      <td>0.683 m</td>
    </tr>
    <tr>
      <td>LOS (EKF)</td>
      <td>0.148 m</td>
      <td>0.141 m</td>
      <td>0.270 m</td>
    </tr>
    <tr>
      <td>LOS (CNN)</td>
      <td>0.154 m</td>
      <td>0.146 m</td>
      <td>0.283 m</td>
    </tr>
  </tbody>
</table>

<p>The results show that, the model learned from channel impulse response signals performs very similarly with the conventional signal processing methodology. In the case of multipath, the CNN (our trained model) is superior as it has learned how to deal with signals experiencing heavy non-linear effects.</p>

<h2 id="conclusions">Conclusions</h2>
<p>This was the first project on which I worked after joining Fraunhofer IIS in Nürnberg. It was also one with most accomplishments (2 publications, 1 best paper award and demonstrator at the MWC). Working on this project, I learned a lot about radiowave-based positioning in terms of theory and practise. 
Furthermore, I gained very good intuition in designing and training convolutional neural networks.</p>

<p>More details in the publications listed below!</p>
<h2 id="publications">Publications</h2>
<p><a href="https://ieeexplore.ieee.org/document/8533766" target="_blank" rel="external nofollow noopener">A Deep Learning Approach to Position Estimation from Channel Impulse Responses</a>
<a href="https://www.mdpi.com/1424-8220/19/5/1064" target="_blank" rel="external nofollow noopener">Convolutional Neural Networks for Position Estimation in TDoA-Based Locating Systems</a></p>

          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2024 Arne  Niitsoo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.
Last updated: January 27, 2024.
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-177262811-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ window.dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-177262811-1');
  </script><!-- Cronitor RUM -->
<script async src="https://rum.cronitor.io/script.js"></script>
<script>
    window.cronitor = window.cronitor || function() { (window.cronitor.q = window.cronitor.q || []).push(arguments); };
    cronitor('config', { clientKey: '0becbec9d8fd010afa6a15bd679b2300' });
</script>
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
